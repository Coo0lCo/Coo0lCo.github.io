<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringBootè‡ªåŠ¨é…ç½®åŸç† | @emt/blog</title>
    <meta name="generator" content="VuePress 1.9.8">
    
    <meta name="description" content="
è‡ªåŠ¨é…ç½®åŸç†

è‡ªåŠ¨é…ç½®è¯´ç™½äº†å°±æ˜¯ï¼Œè‡ªåŠ¨å¯¼å…¥æ‰€æœ‰çš„ç»„ä»¶ï¼ˆåŒ…å†… / åŒ…å¤–ï¼‰ï¼Œåœ¨è¿™é‡Œç»Ÿä¸€ä¸€ä¸‹æ¦‚å¿µï¼Œæ‰€è¯´çš„é…ç½®ã€å¯¼å…¥ã€ç»„ä»¶ï¼Œè¿™äº›æ¦‚å¿µå¤§ç™½è¯å°±æ˜¯æŠŠéœ€è¦æ”¾å…¥IOCå®¹å™¨ä¸­çš„ç±»ï¼Œæ³¨å†Œè¿›å®¹å™¨

å…ˆå†³æ¡ä»¶ï¼š

&gt; å…¶å®è‡ªåŠ¨é…ç½®åŸç†å…¨éƒ½åŸºäºä»¥ä¸‹å››æ ·ä¸œè¥¿ï¼Œéƒ½æ˜¯æ¥è‡ªSpringï¼Œè¿™æ˜¯å…ˆå†³æ¡ä»¶
&gt; è‡ªåŠ¨é…ç½®è‚¯å®šæ˜¯runäº†ä¹‹åå‘ç”Ÿçš„ï¼Œå…·ä½“åœ°è¯´æ˜¯AnnotationConfigApplicationConte ...">
    
    <link rel="preload" href="/assets/css/0.styles.82ff4c1c.css" as="style"><link rel="preload" href="/assets/js/app.fa016951.js" as="script"><link rel="preload" href="/assets/js/6.35667c68.js" as="script"><link rel="preload" href="/assets/js/3.1f7bf9c9.js" as="script"><link rel="preload" href="/assets/js/14.f010515b.js" as="script"><link rel="prefetch" href="/assets/js/10.bcfdcdde.js"><link rel="prefetch" href="/assets/js/11.ec5f4628.js"><link rel="prefetch" href="/assets/js/12.fa5693d6.js"><link rel="prefetch" href="/assets/js/13.f2e9ea2d.js"><link rel="prefetch" href="/assets/js/15.a4d3699b.js"><link rel="prefetch" href="/assets/js/16.a93b32ba.js"><link rel="prefetch" href="/assets/js/4.7c9beb84.js"><link rel="prefetch" href="/assets/js/5.b61afa94.js"><link rel="prefetch" href="/assets/js/7.88185639.js"><link rel="prefetch" href="/assets/js/8.e3d66a55.js"><link rel="prefetch" href="/assets/js/9.1367ae18.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.39b7a217.js">
    <link rel="stylesheet" href="/assets/css/0.styles.82ff4c1c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">@emt/blog </a></div> <div class="header-right-wrap"><!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">@emt/blog </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <!----></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        
      </h1> <div class="post-meta"><!----> <!----> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/Java" data-v-42ccfcd5><span data-v-42ccfcd5>Java</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/æ¡†æ¶" data-v-42ccfcd5><span data-v-42ccfcd5>æ¡†æ¶</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/SpringBoot" data-v-42ccfcd5><span data-v-42ccfcd5>SpringBoot</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/è‡ªåŠ¨é…ç½®åŸç†" data-v-42ccfcd5><span data-v-42ccfcd5>è‡ªåŠ¨é…ç½®åŸç†</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h1 id="springbootè‡ªåŠ¨é…ç½®åŸç†"><a href="#springbootè‡ªåŠ¨é…ç½®åŸç†" class="header-anchor">#</a> SpringBootè‡ªåŠ¨é…ç½®åŸç†</h1> <h2 id="è‡ªåŠ¨é…ç½®åŸç†"><a href="#è‡ªåŠ¨é…ç½®åŸç†" class="header-anchor">#</a> è‡ªåŠ¨é…ç½®åŸç†</h2> <p>è‡ªåŠ¨é…ç½®è¯´ç™½äº†å°±æ˜¯ï¼Œè‡ªåŠ¨å¯¼å…¥æ‰€æœ‰çš„ç»„ä»¶ï¼ˆåŒ…å†… / åŒ…å¤–ï¼‰ï¼Œåœ¨è¿™é‡Œç»Ÿä¸€ä¸€ä¸‹æ¦‚å¿µï¼Œæ‰€è¯´çš„é…ç½®ã€å¯¼å…¥ã€ç»„ä»¶ï¼Œè¿™äº›æ¦‚å¿µå¤§ç™½è¯å°±æ˜¯æŠŠéœ€è¦æ”¾å…¥IOCå®¹å™¨ä¸­çš„ç±»ï¼Œæ³¨å†Œè¿›å®¹å™¨</p> <h3 id="å…ˆå†³æ¡ä»¶"><a href="#å…ˆå†³æ¡ä»¶" class="header-anchor">#</a> å…ˆå†³æ¡ä»¶ï¼š</h3> <blockquote><p>å…¶å®è‡ªåŠ¨é…ç½®åŸç†å…¨éƒ½åŸºäºä»¥ä¸‹å››æ ·ä¸œè¥¿ï¼Œéƒ½æ˜¯æ¥è‡ªSpringï¼Œè¿™æ˜¯å…ˆå†³æ¡ä»¶
è‡ªåŠ¨é…ç½®è‚¯å®šæ˜¯runäº†ä¹‹åå‘ç”Ÿçš„ï¼Œå…·ä½“åœ°è¯´æ˜¯AnnotationConfigApplicationContextåˆ·æ–°çš„æ—¶å€™å‘ç”Ÿè‡ªåŠ¨é…ç½®å•¦ï¼ï¼Œèµ°çš„å°±æ˜¯Spring
iocå®¹å™¨åˆå§‹åŒ–é‚£å¥—æµç¨‹äº†</p></blockquote> <ol><li>@Import ----- å¯¼å…¥ 2 3</li> <li>ImportSelectoræ¥å£ ---- å…¨é™å®šå</li> <li>ImportBeanDefinitionRegisteræ¥å£ ----- ç›´æ¥æ³¨å†ŒBeanDefinition</li> <li>@AutoConfigurationï¼ˆè¿™ä¸ªæ¥è‡ªSpringBootï¼ŒåŒ…è£…äº†ä¸€ä¸‹ï¼‰çš„å‰èº«@Configurationï¼ˆè¿™ä¸ªå¯æ˜¯æ¥è‡ªSpringæ»´ï¼‰ ------- ç–¯ç‹‚å¯¼å…¥nä¸ªBeanä¸å¤šè§£é‡Š</li></ol> <h3 id="æ ¸å¿ƒåŸç†"><a href="#æ ¸å¿ƒåŸç†" class="header-anchor">#</a> æ ¸å¿ƒåŸç†</h3> <p>å®ç°åŸç†å¾ˆç®€å•å°±æ˜¯ä¾èµ–@Importçš„å¯¼å…¥æœºåˆ¶ï¼Œ@Importæ˜¯Springæä¾›çš„ï¼Œå…·ä½“ä½äºspring-context
</p><div align="center"><img src="https://p.ipic.vip/1juido.png" alt="loading..."></div><p></p> <h3 id="importä¸ºautoconfigæä¾›äº†å“ªäº›èƒ½åŠ›"><a href="#importä¸ºautoconfigæä¾›äº†å“ªäº›èƒ½åŠ›" class="header-anchor">#</a> @Importä¸ºAutoConfigæä¾›äº†å“ªäº›èƒ½åŠ›ï¼Ÿ</h3> <ul><li>å¯¼å…¥ImportSelectorå®ç°ç±» --- å¯¼å…¥åŒ…å¤–ç»„ä»¶</li> <li>å¯¼å…¥ImportBeanDefinitionRegistrarå®ç°ç±» ---- å¯¼å…¥åŒ…å†…ç»„ä»¶</li></ul> <hr> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">TYPE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token annotation punctuation">@Inherited</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationPackages<span class="token punctuation">.</span>Registrar</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">//å…³é”®æ€§ä»£ç </span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">AutoConfigurationPackage</span> <span class="token punctuation">{</span>

   <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">basePackages</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

   <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">basePackageClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="_1-æ³¨å†ŒåŒ…å†…æ‰€æœ‰ç»„ä»¶"><a href="#_1-æ³¨å†ŒåŒ…å†…æ‰€æœ‰ç»„ä»¶" class="header-anchor">#</a> 1.æ³¨å†ŒåŒ…å†…æ‰€æœ‰ç»„ä»¶</h4> <p>æˆ‘ä»¬å†å…³æ³¨@Importå¯¼å…¥çš„AutoConfigurationPackages.Registrarç©¶ç«Ÿä¸ºæˆ‘ä»¬æ³¨å†Œäº†å“ªäº›åœ°æ–¹çš„Bean
æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€è·¯è¿½è¸ªæºä»£ç </p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//Registraræ˜¯AutoConfigurationPackagesä¸‹çš„é™æ€å†…éƒ¨ç±»ï¼Œåšäº†ä¸€ä¸ªåŒ…è£…</span>

<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Registrar</span> <span class="token keyword">implements</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span><span class="token punctuation">,</span> <span class="token class-name">DeterminableImports</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">register</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PackageImports</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackageNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">determineImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PackageImports</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//æœ€ç»ˆè°ƒç”¨äº†registerï¼ˆã€‚ã€‚ã€‚ï¼‰</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> packageNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>registry<span class="token punctuation">.</span><span class="token function">containsBeanDefinition</span><span class="token punctuation">(</span><span class="token constant">BEAN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">BasePackagesBeanDefinition</span> beanDefinition <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BasePackagesBeanDefinition</span><span class="token punctuation">)</span> registry<span class="token punctuation">.</span><span class="token function">getBeanDefinition</span><span class="token punctuation">(</span><span class="token constant">BEAN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      beanDefinition<span class="token punctuation">.</span><span class="token function">addBasePackages</span><span class="token punctuation">(</span>packageNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">else</span> <span class="token punctuation">{</span>
      registry<span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token constant">BEAN</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BasePackagesBeanDefinition</span><span class="token punctuation">(</span>packageNames<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ä¸ªBEANæˆ‘ä»¬å»Debugå¾ˆå®¹æ˜“å‘ç°å°±æ˜¯å¸¦@SpringBootApplicationé‚£ä¸ªç±»ï¼Œå†å‡†ç¡®ç‚¹è¯´æ˜¯å¸¦@AutoConfigurationPackageçš„ç±»çš„æ‰€åœ¨è·¯å¾„ï¼ˆåŠ ä¸Šè·¯å¾„ä¸‹çš„åŒ…å+ç±»åå°±æ˜¯å…¨é™å®šåäº†ï¼‰
è¿™é‡Œæˆ‘ä»¬å¤§æ¦‚å°±èƒ½çŒœåˆ°äº†ï¼ŒAutoConfigurationPackages.Registraræ˜¯æ³¨å†Œæ‰€å¸¦@AutoConfigurationPackageçš„ç±»çš„æ‰€åœ¨è·¯å¾„ä¸‹çš„æ‰€æœ‰ç»„ä»¶çš„ï¼ˆå¸¦@Component......ç­‰ç­‰çš„ç±»ï¼‰</p> <hr> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAutoConfiguration</span> <span class="token punctuation">{</span>

   <span class="token class-name">String</span> <span class="token constant">ENABLED_OVERRIDE_PROPERTY</span> <span class="token operator">=</span> <span class="token string">&quot;spring.boot.enableautoconfiguration&quot;</span><span class="token punctuation">;</span>
   
   <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

   <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">excludeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>åŒæ ·å‡ºè‡ª@SpringBootApplicationä¸‹çš„@EnableAutoConfigurationæ³¨è§£å†…éƒ¨ï¼Œåœ¨æ­¤å¯¼å…¥çš„AutoConfigurationImportSelectoræ˜¯ä¸ºæˆ‘ä»¬å¯¼å…¥åŒ…å¤–ç»„ä»¶çš„å¯¼å…¥å™¨ï¼ŒAutoConfigurationImportSelectoræ˜¯å®ç°è‡ªImportSelectorï¼Œé‚£ä¹ˆä»–å°±æ˜¯é€šè¿‡è¿”å›ä¸€ä¸ªå…¨é™å®šåString[]
æ•°ç»„æ¥æ·»åŠ å®¹å™¨ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹</p> <ul><li><p>ä»–æ˜¯å¦‚ä½•å»å¾—åˆ°æ‰€æœ‰åŒ…å¤–çš„ç»„ä»¶ï¼Ÿ</p></li> <li><p>åŒ…å¤–ç»„ä»¶çš„å…¨é™å®šååœ¨ä»€ä¹ˆä½ç½®ï¼Ÿ</p></li> <li><p>åˆç»è¿‡äº†å“ªäº›ç­›é€‰è¿‡æ»¤ï¼Ÿ
èµ°è¿›AutoConfigurationImportSelectorå†…éƒ¨ï¼š
æˆ‘ä»¬çŸ¥é“å½“@Importå¯¼å…¥äº†ä¸€ä¸ªImportSelectorçš„å®ç°ç±»ä¹‹åå°±ä¼šè‡ªåŠ¨çš„è°ƒç”¨ä¸€æ¬¡ä¸‹é¢çš„æ–¹æ³•
String[] selectImports(AnnotationMetadata importingClassMetadata);
é‚£ä¹ˆAutoConfigurationImportSelectoråˆæ˜¯å¦‚ä½•å»å®ç°è¿™ä¸ªæ“ä½œçš„ï¼Œå¦‚ä¸‹å›¾ï¼š</p> <div align="center"><img src="https://p.ipic.vip/btbaed.jpg" alt="loading..."></div></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">selectImports</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token constant">NO_IMPORTS</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token class-name">AutoConfigurationEntry</span> autoConfigurationEntry <span class="token operator">=</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">toStringArray</span><span class="token punctuation">(</span>autoConfigurationEntry<span class="token punctuation">.</span><span class="token function">getConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> metadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//é¦–å…ˆåˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯AutoConfigurationImportSelectorçš„å®ä¾‹</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//å†å»çœ‹çœ‹å¯¼å…¥è¯¥ImportSelectorçš„æ³¨è§£æ˜¯ä¸æ˜¯ä½äºEnableAutoConfigurationæ³¨è§£ä¸Šé¢</span>
   <span class="token comment">//æ‰€ä»¥EnableAutoConfigurationæ˜¯å¼€å¯è‡ªåŠ¨é…ç½®æœ€ä¸ºæ ¸å¿ƒçš„æ ‡å¿—</span>
      <span class="token keyword">return</span> <span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">EnableAutoConfiguration</span><span class="token punctuation">.</span><span class="token constant">ENABLED_OVERRIDE_PROPERTY</span><span class="token punctuation">,</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åˆ¤æ–­å®Œäº†ä¹‹åå°±æ˜¯é‡å¤´æˆï¼ï¼ï¼ï¼ï¼å¼€æ•´ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å»æ‹¿åŒ…å¤–ç»„ä»¶çš„è¿‡ç¨‹ï¼Œspringbootç”¨äº†ä¸€ä¸ªAutoConfigurationEntryè¿™ä¸ªentryæ¥å°è£…å…ƒæ•°æ®ï¼Œå†…éƒ¨è¯´ç™½äº†å°±æ˜¯listå’Œseté›†åˆï¼Œsetè‚¯å®šæœ‰å»é‡è¿‡æ»¤çš„åŠŸèƒ½å•¦ç¨å¾®é¢„å‘Šä¸€ä¸‹ï¼ï½ï½ï½ï½</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">AutoConfigurationEntry</span> <span class="token punctuation">{</span>
    
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> exclusions<span class="token punctuation">;</span>

   <span class="token keyword">private</span> <span class="token class-name">AutoConfigurationEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>configurations <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>exclusions <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token class-name">AutoConfigurationEntry</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations<span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> exclusions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>configurations <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>exclusions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getConfigurations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>configurations<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getExclusions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>exclusions<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="_1-åŒ…å¤–æ‰€æœ‰çš„ç»„ä»¶è·å–"><a href="#_1-åŒ…å¤–æ‰€æœ‰çš„ç»„ä»¶è·å–" class="header-anchor">#</a> 1.åŒ…å¤–æ‰€æœ‰çš„ç»„ä»¶è·å–</h4> <ul><li><div class="language-java extra-class"><pre class="language-java"><code>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations
</code></pre></div><p>listå°±æ˜¯è¿™ç©æ„å„¿ï¼Œä»€ä¹ˆï¼Ÿè¿™ä¹ˆçœ¼ç†Ÿï¼Ÿå…¨éƒ½æ˜¯AutoConfigurationï¼ï¼
ä»å“ªæ¥ï¼ˆæ‰€æœ‰çš„META-INF/spring.factoriesï¼ŒåŒ…æ‹¬ç¬¬ä¸‰æ–¹å¯¼å…¥çš„starteré‡Œçš„å’Œæœ¬èº«autoconfigureåŒ…ä¸‹çš„ï¼‰ï¼Ÿåˆæ˜¯æ€ä¹ˆå¾—æ¥çš„ï¼ˆSpringFactoriesLoaderï¼ï¼ï¼ä¸ºæˆ‘ä»¬æ‹¿åˆ°çš„ï¼‰ï¼Ÿ
<img src="https://p.ipic.vip/tod2zz.jpg" alt=""></p></li> <li><div class="language-java extra-class"><pre class="language-java"><code>  <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> exclusions
</code></pre></div><p>exclusionså¾ˆç®€å•ï¼Œå°±æ˜¯éœ€è¦æ’å‡ºçš„ç»„ä»¶çš„é›†åˆï¼Œè¿™é‡Œæš‚ä¸”ä¸ç»™å‡ºæ˜¯æ€ä¹ˆæ¥çš„ï¼Œæ˜¯ç»è¿‡æ€æ ·çš„è§„åˆ™å¾—æ¥çš„
æ‹¿åˆ°åŸå§‹çš„ç»„ä»¶é›†åˆå°è£…ä¹‹åå°±æ˜¯ 1.è¿‡æ»¤ 2.æ’é™¤
æ— éå°±æ˜¯çœ‹ä»–æºä»£ç çš„è¿‡æ»¤è§„åˆ™ï¼Œå’Œéœ€è¦æ’é™¤å“ªäº›ç»„ä»¶ï¼Œé¡ºå¸¦æˆ‘ä»¬å¯ä»¥è§£å†³ä¸€äº›ä¸ªé—®é¢˜----ä¸ºå•¥è¦è¿‡æ»¤ç»„ä»¶å‘€ï¼Ÿæ’é™¤ç»„ä»¶è¿™ä¸ªå’±æ˜¯ä¸æ˜¯èƒ½è‡ªå·±å®šä¹‰å‘€å•Šï¼Ÿ</p></li></ul> <h4 id="_2-ç»„ä»¶è¿‡æ»¤æœºåˆ¶"><a href="#_2-ç»„ä»¶è¿‡æ»¤æœºåˆ¶" class="header-anchor">#</a> 2.ç»„ä»¶è¿‡æ»¤æœºåˆ¶</h4> <p>åœ¨è¿™ä¹‹å‰æœ‰å»é™¤é‡å¤ç»„ä»¶çš„æ“ä½œï¼Œå¾ˆç®€å•å°±æ˜¯setå»é‡ï¼Œå°±ä¸å¤šè§£é‡Šäº†
é‡å¤´æˆï¼š
è¿‡æ»¤æ“ä½œçš„æ ¸å¿ƒä»£ç ï¼š
<img src="https://p.ipic.vip/c7g4x3.jpg" alt="">
æˆ‘ä»¬å»å…³æ³¨ä¸€ä¸‹AutoConfigurationImportFilterå°±å¯ä»¥çŸ¥é“åˆ é™¤çš„è§„åˆ™å¦‚ä¸‹ï¼š
<img src="https://p.ipic.vip/nxv6uu.jpg" alt="">
æœ‰4ç§åˆ é™¤è§„åˆ™</p> <ol><li>OnBeanCondition --- @ConditionalOnBean
åœ¨ç±»è·¯å¾„ä¸‹æœ‰æŒ‡å®šçš„Beanæƒ…å†µä¸‹åŠ è½½</li> <li>OnClassCondition --- @ConditionalOnClass
åœ¨ç±»è·¯å¾„ä¸‹æœ‰æŒ‡å®šç±»çš„æƒ…å†µä¸‹åŠ è½½</li> <li>OnWebApplicationCondition --- @ConditionalOnWebApplication
å½“é¡¹ç›®æ˜¯ä¸€ä¸ªWebé¡¹ç›®çš„æ—¶å€™åŠ è½½
å½“ç„¶ä¸æ­¢è¿™äº›è¿˜æœ‰å¾ˆå¤šå°±ä¸ä¸€ä¸€æ¦‚è¿°äº†
<img src="https://p.ipic.vip/nxv6uu.jpg" alt=""></li></ol> <h4 id="_3-è‡ªå®šä¹‰è¦æ’é™¤çš„ç»„ä»¶"><a href="#_3-è‡ªå®šä¹‰è¦æ’é™¤çš„ç»„ä»¶" class="header-anchor">#</a> 3.è‡ªå®šä¹‰è¦æ’é™¤çš„ç»„ä»¶</h4> <p>ä¸å¤šè§£é‡Šç®€å•æ˜“æ‡‚
ç›´æ¥é…ç½®application.propertieså°±å®Œäº‹äº†
spring.autoconfigure.exclude=ä½ è¦æ’é™¤çš„ç»„ä»¶å…¨é™å®šå</p> <h3 id="æœ€åæˆ‘ä»¬è‡ªå·±æ¥å®è·µä¸€ä¸ªstarter"><a href="#æœ€åæˆ‘ä»¬è‡ªå·±æ¥å®è·µä¸€ä¸ªstarter" class="header-anchor">#</a> æœ€åæˆ‘ä»¬è‡ªå·±æ¥å®è·µä¸€ä¸ªstarter</h3> <p>å§‘ä¸”å«åšspring-boot-starter-zhuangb</p> <ol><li><p>ç®€è¿°ä¸€ä¸‹è¯¥starterçš„éœ€æ±‚ï¼š</p></li> <li><p>æä¾›å¿«é€Ÿè£…é€¼èƒ½åŠ›</p></li> <li><p>ä½¿ç”¨è€…å¯ç›´æ¥å¯¼å…¥spring-boot-starter-zhuangbå¼€å¯è£…é€¼èƒ½åŠ›</p></li> <li><p>éœ€è¦æä¾›è£…é€¼ç”¨æˆ·çš„å§“åã€å¹´é¾„ã€è£…é€¼å†…å®¹context</p></li> <li><p>ç®€è¿°éœ€è¦æ„å»ºå“ªäº›ç±»å’Œæ–‡ä»¶ï¼š</p></li> <li><p>xxxAutoConfigurationç±» ------ ç”¨äºç»„ä»¶æ³¨å†Œbean</p></li> <li><p>ä¸€ä¸ªè£…é€¼ç”¨æˆ·çš„ä¿¡æ¯propertiesç±» ------- ç”¨äºåŠ¨æ€æ³¨å…¥ç”¨æˆ·åœ¨application.propertiesçš„é…ç½®</p></li> <li><p>æ ‡å‡†çš„META-INF/spring.factoriesç”¨äºæä¾›ç»™spring-boot-autoconfigureè¯»å–åŒ…å¤–ç»„ä»¶</p></li> <li><p>ä¸Šä»£ç å®ç°ï¼š
githubé“¾æ¥
é¡¹ç›®ç»“æ„
<img src="https://p.ipic.vip/nxv6uu.jpg" alt=""></p></li> <li></li></ol> <p>æ„å»ºå®Œä»£ç ä¹‹åé€šè¿‡mavenæ‰“åŒ…ï¼ŒåŒä¸€ä¸ªå·¥ç¨‹å†…éƒ¨çš„è¯ç›´æ¥å¼•å…¥ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œç”šè‡³ä½ å¯ä»¥å°†ä¾èµ–åŒ…ä¸Šä¼ è‡³ç§æœå¼€æºè¿™æ ·everybodyéƒ½èƒ½å¯¼å…¥å¹¶ä¸‹è½½åˆ°è¿™ä¸ªjaråŒ…ï¼Œåªéœ€è¦åœ¨ä½ éœ€è¦çš„SpringBootå·¥ç¨‹å†…éƒ¨å¯¼å…¥spring-boot-starter-zhuangbä¾èµ–åŒ…å°±è¡Œ
ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®ğŸ®</p> <Vssue title="SpringBootè‡ªåŠ¨é…ç½®åŸç† | @emt/blog"></Vssue></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#è‡ªåŠ¨é…ç½®åŸç†" title="è‡ªåŠ¨é…ç½®åŸç†">è‡ªåŠ¨é…ç½®åŸç†</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#å…ˆå†³æ¡ä»¶" title="å…ˆå†³æ¡ä»¶ï¼š">å…ˆå†³æ¡ä»¶ï¼š</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#æ ¸å¿ƒåŸç†" title="æ ¸å¿ƒåŸç†">æ ¸å¿ƒåŸç†</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#importä¸ºautoconfigæä¾›äº†å“ªäº›èƒ½åŠ›" title="@Importä¸ºAutoConfigæä¾›äº†å“ªäº›èƒ½åŠ›ï¼Ÿ">@Importä¸ºAutoConfigæä¾›äº†å“ªäº›èƒ½åŠ›ï¼Ÿ</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#æœ€åæˆ‘ä»¬è‡ªå·±æ¥å®è·µä¸€ä¸ªstarter" title="æœ€åæˆ‘ä»¬è‡ªå·±æ¥å®è·µä¸€ä¸ªstarter">æœ€åæˆ‘ä»¬è‡ªå·±æ¥å®è·µä¸€ä¸ªstarter</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fa016951.js" defer></script><script src="/assets/js/6.35667c68.js" defer></script><script src="/assets/js/3.1f7bf9c9.js" defer></script><script src="/assets/js/14.f010515b.js" defer></script>
  </body>
</html>
